!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("d3-selection"),require("d3")):"function"==typeof define&&define.amd?define(["d3-selection","d3"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).Legend=e(t.d3,t.d3)}(this,(function(t,e){"use strict";function n(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,r(o.key),o)}}function r(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}var o,i,a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s=function(t){try{return!!t()}catch(t){return!0}},u=!s((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),c=!s((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),l=c,f=Function.prototype,h=f.call,p=l&&f.bind.bind(h,h),d=l?p:function(t){return function(){return h.apply(t,arguments)}},g=function(t){return null==t},v=g,m=TypeError,y=function(t){if(v(t))throw m("Can't call method on "+t);return t},b=y,w=Object,P=function(t){return w(b(t))},S=P,O=d({}.hasOwnProperty),j=Object.hasOwn||function(t,e){return O(S(t),e)},x=u,$=j,T=Function.prototype,R=x&&Object.getOwnPropertyDescriptor,E=$(T,"name"),k={EXISTS:E,PROPER:E&&"something"===function(){}.name,CONFIGURABLE:E&&(!x||x&&R(T,"name").configurable)},M={},C=function(t){return t&&t.Math==Math&&t},q=C("object"==typeof globalThis&&globalThis)||C("object"==typeof window&&window)||C("object"==typeof self&&self)||C("object"==typeof a&&a)||function(){return this}()||Function("return this")(),N="object"==typeof document&&document.all,B={all:N,IS_HTMLDDA:void 0===N&&void 0!==N},I=B.all,A=B.IS_HTMLDDA?function(t){return"function"==typeof t||t===I}:function(t){return"function"==typeof t},D=A,G=B.all,L=B.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:D(t)||t===G}:function(t){return"object"==typeof t?null!==t:D(t)},z=L,F=q.document,Y=z(F)&&z(F.createElement),_=function(t){return Y?F.createElement(t):{}},U=_,W=!u&&!s((function(){return 7!=Object.defineProperty(U("div"),"a",{get:function(){return 7}}).a})),H=u&&s((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),V=L,X=String,J=TypeError,K=function(t){if(V(t))return t;throw J(X(t)+" is not an object")},Z=c,Q=Function.prototype.call,tt=Z?Q.bind(Q):function(){return Q.apply(Q,arguments)},et=q,nt=A,rt=function(t){return nt(t)?t:void 0},ot=function(t,e){return arguments.length<2?rt(et[t]):et[t]&&et[t][e]},it=d({}.isPrototypeOf),at=ot("navigator","userAgent")||"",st=q,ut=at,ct=st.process,lt=st.Deno,ft=ct&&ct.versions||lt&&lt.version,ht=ft&&ft.v8;ht&&(i=(o=ht.split("."))[0]>0&&o[0]<4?1:+(o[0]+o[1])),!i&&ut&&(!(o=ut.match(/Edge\/(\d+)/))||o[1]>=74)&&(o=ut.match(/Chrome\/(\d+)/))&&(i=+o[1]);var pt=i,dt=pt,gt=s,vt=!!Object.getOwnPropertySymbols&&!gt((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&dt&&dt<41})),mt=vt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,yt=ot,bt=A,wt=it,Pt=Object,St=mt?function(t){return"symbol"==typeof t}:function(t){var e=yt("Symbol");return bt(e)&&wt(e.prototype,Pt(t))},Ot=String,jt=function(t){try{return Ot(t)}catch(t){return"Object"}},xt=A,$t=jt,Tt=TypeError,Rt=function(t){if(xt(t))return t;throw Tt($t(t)+" is not a function")},Et=Rt,kt=g,Mt=function(t,e){var n=t[e];return kt(n)?void 0:Et(n)},Ct=tt,qt=A,Nt=L,Bt=TypeError,It={},At={get exports(){return It},set exports(t){It=t}},Dt=q,Gt=Object.defineProperty,Lt=function(t,e){try{Gt(Dt,t,{value:e,configurable:!0,writable:!0})}catch(n){Dt[t]=e}return e},zt=Lt,Ft="__core-js_shared__",Yt=q[Ft]||zt(Ft,{}),_t=Yt;(At.exports=function(t,e){return _t[t]||(_t[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.26.1",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Ut=d,Wt=0,Ht=Math.random(),Vt=Ut(1..toString),Xt=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Vt(++Wt+Ht,36)},Jt=q,Kt=j,Zt=Xt,Qt=vt,te=mt,ee=It("wks"),ne=Jt.Symbol,re=ne&&ne.for,oe=te?ne:ne&&ne.withoutSetter||Zt,ie=function(t){if(!Kt(ee,t)||!Qt&&"string"!=typeof ee[t]){var e="Symbol."+t;Qt&&Kt(ne,t)?ee[t]=ne[t]:ee[t]=te&&re?re(e):oe(e)}return ee[t]},ae=tt,se=L,ue=St,ce=Mt,le=function(t,e){var n,r;if("string"===e&&qt(n=t.toString)&&!Nt(r=Ct(n,t)))return r;if(qt(n=t.valueOf)&&!Nt(r=Ct(n,t)))return r;if("string"!==e&&qt(n=t.toString)&&!Nt(r=Ct(n,t)))return r;throw Bt("Can't convert object to primitive value")},fe=TypeError,he=ie("toPrimitive"),pe=function(t,e){if(!se(t)||ue(t))return t;var n,r=ce(t,he);if(r){if(void 0===e&&(e="default"),n=ae(r,t,e),!se(n)||ue(n))return n;throw fe("Can't convert object to primitive value")}return void 0===e&&(e="number"),le(t,e)},de=St,ge=function(t){var e=pe(t,"string");return de(e)?e:e+""},ve=u,me=W,ye=H,be=K,we=ge,Pe=TypeError,Se=Object.defineProperty,Oe=Object.getOwnPropertyDescriptor,je="enumerable",xe="configurable",$e="writable";M.f=ve?ye?function(t,e,n){if(be(t),e=we(e),be(n),"function"==typeof t&&"prototype"===e&&"value"in n&&$e in n&&!n[$e]){var r=Oe(t,e);r&&r[$e]&&(t[e]=n.value,n={configurable:xe in n?n[xe]:r[xe],enumerable:je in n?n[je]:r[je],writable:!1})}return Se(t,e,n)}:Se:function(t,e,n){if(be(t),e=we(e),be(n),me)try{return Se(t,e,n)}catch(t){}if("get"in n||"set"in n)throw Pe("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var Te=u,Re=k.EXISTS,Ee=d,ke=M.f,Me=Function.prototype,Ce=Ee(Me.toString),qe=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,Ne=Ee(qe.exec);Te&&!Re&&ke(Me,"name",{configurable:!0,get:function(){try{return Ne(qe,Ce(this))[1]}catch(t){return""}}});var Be={},Ie={},Ae={}.propertyIsEnumerable,De=Object.getOwnPropertyDescriptor,Ge=De&&!Ae.call({1:2},1);Ie.f=Ge?function(t){var e=De(this,t);return!!e&&e.enumerable}:Ae;var Le=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},ze=d,Fe=ze({}.toString),Ye=ze("".slice),_e=function(t){return Ye(Fe(t),8,-1)},Ue=s,We=_e,He=Object,Ve=d("".split),Xe=Ue((function(){return!He("z").propertyIsEnumerable(0)}))?function(t){return"String"==We(t)?Ve(t,""):He(t)}:He,Je=Xe,Ke=y,Ze=function(t){return Je(Ke(t))},Qe=u,tn=tt,en=Ie,nn=Le,rn=Ze,on=ge,an=j,sn=W,un=Object.getOwnPropertyDescriptor;Be.f=Qe?un:function(t,e){if(t=rn(t),e=on(e),sn)try{return un(t,e)}catch(t){}if(an(t,e))return nn(!tn(en.f,t,e),t[e])};var cn=M,ln=Le,fn=u?function(t,e,n){return cn.f(t,e,ln(1,n))}:function(t,e,n){return t[e]=n,t},hn={},pn={get exports(){return hn},set exports(t){hn=t}},dn=A,gn=Yt,vn=d(Function.toString);dn(gn.inspectSource)||(gn.inspectSource=function(t){return vn(t)});var mn,yn,bn,wn=gn.inspectSource,Pn=A,Sn=q.WeakMap,On=Pn(Sn)&&/native code/.test(String(Sn)),jn=Xt,xn=It("keys"),$n={},Tn=On,Rn=q,En=L,kn=fn,Mn=j,Cn=Yt,qn=function(t){return xn[t]||(xn[t]=jn(t))},Nn=$n,Bn="Object already initialized",In=Rn.TypeError,An=Rn.WeakMap;if(Tn||Cn.state){var Dn=Cn.state||(Cn.state=new An);Dn.get=Dn.get,Dn.has=Dn.has,Dn.set=Dn.set,mn=function(t,e){if(Dn.has(t))throw In(Bn);return e.facade=t,Dn.set(t,e),e},yn=function(t){return Dn.get(t)||{}},bn=function(t){return Dn.has(t)}}else{var Gn=qn("state");Nn[Gn]=!0,mn=function(t,e){if(Mn(t,Gn))throw In(Bn);return e.facade=t,kn(t,Gn,e),e},yn=function(t){return Mn(t,Gn)?t[Gn]:{}},bn=function(t){return Mn(t,Gn)}}var Ln={set:mn,get:yn,has:bn,enforce:function(t){return bn(t)?yn(t):mn(t,{})},getterFor:function(t){return function(e){var n;if(!En(e)||(n=yn(e)).type!==t)throw In("Incompatible receiver, "+t+" required");return n}}},zn=s,Fn=A,Yn=j,_n=u,Un=k.CONFIGURABLE,Wn=wn,Hn=Ln.enforce,Vn=Ln.get,Xn=Object.defineProperty,Jn=_n&&!zn((function(){return 8!==Xn((function(){}),"length",{value:8}).length})),Kn=String(String).split("String"),Zn=pn.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Yn(t,"name")||Un&&t.name!==e)&&(_n?Xn(t,"name",{value:e,configurable:!0}):t.name=e),Jn&&n&&Yn(n,"arity")&&t.length!==n.arity&&Xn(t,"length",{value:n.arity});try{n&&Yn(n,"constructor")&&n.constructor?_n&&Xn(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=Hn(t);return Yn(r,"source")||(r.source=Kn.join("string"==typeof e?e:"")),t};Function.prototype.toString=Zn((function(){return Fn(this)&&Vn(this).source||Wn(this)}),"toString");var Qn=A,tr=M,er=hn,nr=Lt,rr=function(t,e,n,r){r||(r={});var o=r.enumerable,i=void 0!==r.name?r.name:e;if(Qn(n)&&er(n,i,r),r.global)o?t[e]=n:nr(e,n);else{try{r.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=n:tr.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},or={},ir=Math.ceil,ar=Math.floor,sr=Math.trunc||function(t){var e=+t;return(e>0?ar:ir)(e)},ur=function(t){var e=+t;return e!=e||0===e?0:sr(e)},cr=ur,lr=Math.max,fr=Math.min,hr=ur,pr=Math.min,dr=function(t){return t>0?pr(hr(t),9007199254740991):0},gr=function(t){return dr(t.length)},vr=Ze,mr=function(t,e){var n=cr(t);return n<0?lr(n+e,0):fr(n,e)},yr=gr,br=function(t){return function(e,n,r){var o,i=vr(e),a=yr(i),s=mr(r,a);if(t&&n!=n){for(;a>s;)if((o=i[s++])!=o)return!0}else for(;a>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},wr={includes:br(!0),indexOf:br(!1)},Pr=j,Sr=Ze,Or=wr.indexOf,jr=$n,xr=d([].push),$r=function(t,e){var n,r=Sr(t),o=0,i=[];for(n in r)!Pr(jr,n)&&Pr(r,n)&&xr(i,n);for(;e.length>o;)Pr(r,n=e[o++])&&(~Or(i,n)||xr(i,n));return i},Tr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Rr=$r,Er=Tr.concat("length","prototype");or.f=Object.getOwnPropertyNames||function(t){return Rr(t,Er)};var kr={};kr.f=Object.getOwnPropertySymbols;var Mr=ot,Cr=or,qr=kr,Nr=K,Br=d([].concat),Ir=Mr("Reflect","ownKeys")||function(t){var e=Cr.f(Nr(t)),n=qr.f;return n?Br(e,n(t)):e},Ar=j,Dr=Ir,Gr=Be,Lr=M,zr=s,Fr=A,Yr=/#|\.prototype\./,_r=function(t,e){var n=Wr[Ur(t)];return n==Vr||n!=Hr&&(Fr(e)?zr(e):!!e)},Ur=_r.normalize=function(t){return String(t).replace(Yr,".").toLowerCase()},Wr=_r.data={},Hr=_r.NATIVE="N",Vr=_r.POLYFILL="P",Xr=_r,Jr=q,Kr=Be.f,Zr=fn,Qr=rr,to=Lt,eo=function(t,e,n){for(var r=Dr(e),o=Lr.f,i=Gr.f,a=0;a<r.length;a++){var s=r[a];Ar(t,s)||n&&Ar(n,s)||o(t,s,i(e,s))}},no=Xr,ro=function(t,e){var n,r,o,i,a,s=t.target,u=t.global,c=t.stat;if(n=u?Jr:c?Jr[s]||to(s,{}):(Jr[s]||{}).prototype)for(r in e){if(i=e[r],o=t.dontCallGetSet?(a=Kr(n,r))&&a.value:n[r],!no(u?r:s+(c?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;eo(i,o)}(t.sham||o&&o.sham)&&Zr(i,"sham",!0),Qr(n,r,i,t)}},oo=$r,io=Tr,ao=Object.keys||function(t){return oo(t,io)},so=u,uo=d,co=tt,lo=s,fo=ao,ho=kr,po=Ie,go=P,vo=Xe,mo=Object.assign,yo=Object.defineProperty,bo=uo([].concat),wo=!mo||lo((function(){if(so&&1!==mo({b:1},mo(yo({},"a",{enumerable:!0,get:function(){yo(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach((function(t){e[t]=t})),7!=mo({},t)[n]||fo(mo({},e)).join("")!=r}))?function(t,e){for(var n=go(t),r=arguments.length,o=1,i=ho.f,a=po.f;r>o;)for(var s,u=vo(arguments[o++]),c=i?bo(fo(u),i(u)):fo(u),l=c.length,f=0;l>f;)s=c[f++],so&&!co(a,u,s)||(n[s]=u[s]);return n}:mo,Po=wo;ro({target:"Object",stat:!0,arity:2,forced:Object.assign!==Po},{assign:Po});var So={};So[ie("toStringTag")]="z";var Oo="[object z]"===String(So),jo=Oo,xo=A,$o=_e,To=ie("toStringTag"),Ro=Object,Eo="Arguments"==$o(function(){return arguments}()),ko=jo?$o:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Ro(t),To))?n:Eo?$o(e):"Object"==(r=$o(e))&&xo(e.callee)?"Arguments":r},Mo=ko,Co=Oo?{}.toString:function(){return"[object "+Mo(this)+"]"};Oo||rr(Object.prototype,"toString",Co,{unsafe:!0});var qo="process"==_e(q.process),No=A,Bo=String,Io=TypeError,Ao=d,Do=K,Go=function(t){if("object"==typeof t||No(t))return t;throw Io("Can't set "+Bo(t)+" as a prototype")},Lo=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Ao(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return Do(n),Go(r),e?t(n,r):n.__proto__=r,n}}():void 0),zo=M.f,Fo=j,Yo=ie("toStringTag"),_o=ot,Uo=M,Wo=u,Ho=ie("species"),Vo=it,Xo=TypeError,Jo=d,Ko=s,Zo=A,Qo=ko,ti=wn,ei=function(){},ni=[],ri=ot("Reflect","construct"),oi=/^\s*(?:class|function)\b/,ii=Jo(oi.exec),ai=!oi.exec(ei),si=function(t){if(!Zo(t))return!1;try{return ri(ei,ni,t),!0}catch(t){return!1}},ui=function(t){if(!Zo(t))return!1;switch(Qo(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return ai||!!ii(oi,ti(t))}catch(t){return!0}};ui.sham=!0;var ci,li,fi,hi,pi=!ri||Ko((function(){var t;return si(si.call)||!si(Object)||!si((function(){t=!0}))||t}))?ui:si,di=pi,gi=jt,vi=TypeError,mi=K,yi=function(t){if(di(t))return t;throw vi(gi(t)+" is not a constructor")},bi=g,wi=ie("species"),Pi=c,Si=Function.prototype,Oi=Si.apply,ji=Si.call,xi="object"==typeof Reflect&&Reflect.apply||(Pi?ji.bind(Oi):function(){return ji.apply(Oi,arguments)}),$i=_e,Ti=d,Ri=function(t){if("Function"===$i(t))return Ti(t)},Ei=Rt,ki=c,Mi=Ri(Ri.bind),Ci=function(t,e){return Ei(t),void 0===e?t:ki?Mi(t,e):function(){return t.apply(e,arguments)}},qi=ot("document","documentElement"),Ni=d([].slice),Bi=TypeError,Ii=/(?:ipad|iphone|ipod).*applewebkit/i.test(at),Ai=q,Di=xi,Gi=Ci,Li=A,zi=j,Fi=s,Yi=qi,_i=Ni,Ui=_,Wi=function(t,e){if(t<e)throw Bi("Not enough arguments");return t},Hi=Ii,Vi=qo,Xi=Ai.setImmediate,Ji=Ai.clearImmediate,Ki=Ai.process,Zi=Ai.Dispatch,Qi=Ai.Function,ta=Ai.MessageChannel,ea=Ai.String,na=0,ra={},oa="onreadystatechange";try{ci=Ai.location}catch(t){}var ia=function(t){if(zi(ra,t)){var e=ra[t];delete ra[t],e()}},aa=function(t){return function(){ia(t)}},sa=function(t){ia(t.data)},ua=function(t){Ai.postMessage(ea(t),ci.protocol+"//"+ci.host)};Xi&&Ji||(Xi=function(t){Wi(arguments.length,1);var e=Li(t)?t:Qi(t),n=_i(arguments,1);return ra[++na]=function(){Di(e,void 0,n)},li(na),na},Ji=function(t){delete ra[t]},Vi?li=function(t){Ki.nextTick(aa(t))}:Zi&&Zi.now?li=function(t){Zi.now(aa(t))}:ta&&!Hi?(hi=(fi=new ta).port2,fi.port1.onmessage=sa,li=Gi(hi.postMessage,hi)):Ai.addEventListener&&Li(Ai.postMessage)&&!Ai.importScripts&&ci&&"file:"!==ci.protocol&&!Fi(ua)?(li=ua,Ai.addEventListener("message",sa,!1)):li=oa in Ui("script")?function(t){Yi.appendChild(Ui("script"))[oa]=function(){Yi.removeChild(this),ia(t)}}:function(t){setTimeout(aa(t),0)});var ca,la,fa,ha,pa,da,ga,va,ma={set:Xi,clear:Ji},ya=q,ba=/ipad|iphone|ipod/i.test(at)&&void 0!==ya.Pebble,wa=/web0s(?!.*chrome)/i.test(at),Pa=q,Sa=Ci,Oa=Be.f,ja=ma.set,xa=Ii,$a=ba,Ta=wa,Ra=qo,Ea=Pa.MutationObserver||Pa.WebKitMutationObserver,ka=Pa.document,Ma=Pa.process,Ca=Pa.Promise,qa=Oa(Pa,"queueMicrotask"),Na=qa&&qa.value;Na||(ca=function(){var t,e;for(Ra&&(t=Ma.domain)&&t.exit();la;){e=la.fn,la=la.next;try{e()}catch(t){throw la?ha():fa=void 0,t}}fa=void 0,t&&t.enter()},xa||Ra||Ta||!Ea||!ka?!$a&&Ca&&Ca.resolve?((ga=Ca.resolve(void 0)).constructor=Ca,va=Sa(ga.then,ga),ha=function(){va(ca)}):Ra?ha=function(){Ma.nextTick(ca)}:(ja=Sa(ja,Pa),ha=function(){ja(ca)}):(pa=!0,da=ka.createTextNode(""),new Ea(ca).observe(da,{characterData:!0}),ha=function(){da.data=pa=!pa}));var Ba=Na||function(t){var e={fn:t,next:void 0};fa&&(fa.next=e),la||(la=e,ha()),fa=e},Ia=q,Aa=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Da=function(){this.head=null,this.tail=null};Da.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var Ga=Da,La=q.Promise,za="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Fa=!za&&!qo&&"object"==typeof window&&"object"==typeof document,Ya=q,_a=La,Ua=A,Wa=Xr,Ha=wn,Va=ie,Xa=Fa,Ja=za,Ka=pt;_a&&_a.prototype;var Za=Va("species"),Qa=!1,ts=Ua(Ya.PromiseRejectionEvent),es=Wa("Promise",(function(){var t=Ha(_a),e=t!==String(_a);if(!e&&66===Ka)return!0;if(!Ka||Ka<51||!/native code/.test(t)){var n=new _a((function(t){t(1)})),r=function(t){t((function(){}),(function(){}))};if((n.constructor={})[Za]=r,!(Qa=n.then((function(){}))instanceof r))return!0}return!e&&(Xa||Ja)&&!ts})),ns={CONSTRUCTOR:es,REJECTION_EVENT:ts,SUBCLASSING:Qa},rs={},os=Rt,is=TypeError,as=function(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw is("Bad Promise constructor");e=t,n=r})),this.resolve=os(e),this.reject=os(n)};rs.f=function(t){return new as(t)};var ss,us,cs,ls=ro,fs=qo,hs=q,ps=tt,ds=rr,gs=Lo,vs=function(t,e,n){t&&!n&&(t=t.prototype),t&&!Fo(t,Yo)&&zo(t,Yo,{configurable:!0,value:e})},ms=function(t){var e=_o(t),n=Uo.f;Wo&&e&&!e[Ho]&&n(e,Ho,{configurable:!0,get:function(){return this}})},ys=Rt,bs=A,ws=L,Ps=function(t,e){if(Vo(e,t))return t;throw Xo("Incorrect invocation")},Ss=function(t,e){var n,r=mi(t).constructor;return void 0===r||bi(n=mi(r)[wi])?e:yi(n)},Os=ma.set,js=Ba,xs=function(t,e){var n=Ia.console;n&&n.error&&(1==arguments.length?n.error(t):n.error(t,e))},$s=Aa,Ts=Ga,Rs=Ln,Es=La,ks=rs,Ms="Promise",Cs=ns.CONSTRUCTOR,qs=ns.REJECTION_EVENT,Ns=ns.SUBCLASSING,Bs=Rs.getterFor(Ms),Is=Rs.set,As=Es&&Es.prototype,Ds=Es,Gs=As,Ls=hs.TypeError,zs=hs.document,Fs=hs.process,Ys=ks.f,_s=Ys,Us=!!(zs&&zs.createEvent&&hs.dispatchEvent),Ws="unhandledrejection",Hs=function(t){var e;return!(!ws(t)||!bs(e=t.then))&&e},Vs=function(t,e){var n,r,o,i=e.value,a=1==e.state,s=a?t.ok:t.fail,u=t.resolve,c=t.reject,l=t.domain;try{s?(a||(2===e.rejection&&Qs(e),e.rejection=1),!0===s?n=i:(l&&l.enter(),n=s(i),l&&(l.exit(),o=!0)),n===t.promise?c(Ls("Promise-chain cycle")):(r=Hs(n))?ps(r,n,u,c):u(n)):c(i)}catch(t){l&&!o&&l.exit(),c(t)}},Xs=function(t,e){t.notified||(t.notified=!0,js((function(){for(var n,r=t.reactions;n=r.get();)Vs(n,t);t.notified=!1,e&&!t.rejection&&Ks(t)})))},Js=function(t,e,n){var r,o;Us?((r=zs.createEvent("Event")).promise=e,r.reason=n,r.initEvent(t,!1,!0),hs.dispatchEvent(r)):r={promise:e,reason:n},!qs&&(o=hs["on"+t])?o(r):t===Ws&&xs("Unhandled promise rejection",n)},Ks=function(t){ps(Os,hs,(function(){var e,n=t.facade,r=t.value;if(Zs(t)&&(e=$s((function(){fs?Fs.emit("unhandledRejection",r,n):Js(Ws,n,r)})),t.rejection=fs||Zs(t)?2:1,e.error))throw e.value}))},Zs=function(t){return 1!==t.rejection&&!t.parent},Qs=function(t){ps(Os,hs,(function(){var e=t.facade;fs?Fs.emit("rejectionHandled",e):Js("rejectionhandled",e,t.value)}))},tu=function(t,e,n){return function(r){t(e,r,n)}},eu=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=2,Xs(t,!0))},nu=function(t,e,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===e)throw Ls("Promise can't be resolved itself");var r=Hs(e);r?js((function(){var n={done:!1};try{ps(r,e,tu(nu,n,t),tu(eu,n,t))}catch(e){eu(n,e,t)}})):(t.value=e,t.state=1,Xs(t,!1))}catch(e){eu({done:!1},e,t)}}};if(Cs&&(Gs=(Ds=function(t){Ps(this,Gs),ys(t),ps(ss,this);var e=Bs(this);try{t(tu(nu,e),tu(eu,e))}catch(t){eu(e,t)}}).prototype,(ss=function(t){Is(this,{type:Ms,done:!1,notified:!1,parent:!1,reactions:new Ts,rejection:!1,state:0,value:void 0})}).prototype=ds(Gs,"then",(function(t,e){var n=Bs(this),r=Ys(Ss(this,Ds));return n.parent=!0,r.ok=!bs(t)||t,r.fail=bs(e)&&e,r.domain=fs?Fs.domain:void 0,0==n.state?n.reactions.add(r):js((function(){Vs(r,n)})),r.promise})),us=function(){var t=new ss,e=Bs(t);this.promise=t,this.resolve=tu(nu,e),this.reject=tu(eu,e)},ks.f=Ys=function(t){return t===Ds||undefined===t?new us(t):_s(t)},bs(Es)&&As!==Object.prototype)){cs=As.then,Ns||ds(As,"then",(function(t,e){var n=this;return new Ds((function(t,e){ps(cs,n,t,e)})).then(t,e)}),{unsafe:!0});try{delete As.constructor}catch(t){}gs&&gs(As,Gs)}ls({global:!0,constructor:!0,wrap:!0,forced:Cs},{Promise:Ds}),vs(Ds,Ms,!1),ms(Ms);var ru={},ou=ru,iu=ie("iterator"),au=Array.prototype,su=ko,uu=Mt,cu=g,lu=ru,fu=ie("iterator"),hu=function(t){if(!cu(t))return uu(t,fu)||uu(t,"@@iterator")||lu[su(t)]},pu=tt,du=Rt,gu=K,vu=jt,mu=hu,yu=TypeError,bu=tt,wu=K,Pu=Mt,Su=Ci,Ou=tt,ju=K,xu=jt,$u=function(t){return void 0!==t&&(ou.Array===t||au[iu]===t)},Tu=gr,Ru=it,Eu=function(t,e){var n=arguments.length<2?mu(t):e;if(du(n))return gu(pu(n,t));throw yu(vu(t)+" is not iterable")},ku=hu,Mu=function(t,e,n){var r,o;wu(t);try{if(!(r=Pu(t,"return"))){if("throw"===e)throw n;return n}r=bu(r,t)}catch(t){o=!0,r=t}if("throw"===e)throw n;if(o)throw r;return wu(r),n},Cu=TypeError,qu=function(t,e){this.stopped=t,this.result=e},Nu=qu.prototype,Bu=function(t,e,n){var r,o,i,a,s,u,c,l=n&&n.that,f=!(!n||!n.AS_ENTRIES),h=!(!n||!n.IS_RECORD),p=!(!n||!n.IS_ITERATOR),d=!(!n||!n.INTERRUPTED),g=Su(e,l),v=function(t){return r&&Mu(r,"normal",t),new qu(!0,t)},m=function(t){return f?(ju(t),d?g(t[0],t[1],v):g(t[0],t[1])):d?g(t,v):g(t)};if(h)r=t.iterator;else if(p)r=t;else{if(!(o=ku(t)))throw Cu(xu(t)+" is not iterable");if($u(o)){for(i=0,a=Tu(t);a>i;i++)if((s=m(t[i]))&&Ru(Nu,s))return s;return new qu(!1)}r=Eu(t,o)}for(u=h?t.next:r.next;!(c=Ou(u,r)).done;){try{s=m(c.value)}catch(t){Mu(r,"throw",t)}if("object"==typeof s&&s&&Ru(Nu,s))return s}return new qu(!1)},Iu=ie("iterator"),Au=!1;try{var Du=0,Gu={next:function(){return{done:!!Du++}},return:function(){Au=!0}};Gu[Iu]=function(){return this},Array.from(Gu,(function(){throw 2}))}catch(t){}var Lu=La,zu=function(t,e){if(!e&&!Au)return!1;var n=!1;try{var r={};r[Iu]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n},Fu=ns.CONSTRUCTOR||!zu((function(t){Lu.all(t).then(void 0,(function(){}))})),Yu=tt,_u=Rt,Uu=rs,Wu=Aa,Hu=Bu;ro({target:"Promise",stat:!0,forced:Fu},{all:function(t){var e=this,n=Uu.f(e),r=n.resolve,o=n.reject,i=Wu((function(){var n=_u(e.resolve),i=[],a=0,s=1;Hu(t,(function(t){var u=a++,c=!1;s++,Yu(n,e,t).then((function(t){c||(c=!0,i[u]=t,--s||r(i))}),o)})),--s||r(i)}));return i.error&&o(i.value),n.promise}});var Vu=ro,Xu=ns.CONSTRUCTOR,Ju=La,Ku=ot,Zu=A,Qu=rr,tc=Ju&&Ju.prototype;if(Vu({target:"Promise",proto:!0,forced:Xu,real:!0},{catch:function(t){return this.then(void 0,t)}}),Zu(Ju)){var ec=Ku("Promise").prototype.catch;tc.catch!==ec&&Qu(tc,"catch",ec,{unsafe:!0})}var nc=tt,rc=Rt,oc=rs,ic=Aa,ac=Bu;ro({target:"Promise",stat:!0,forced:Fu},{race:function(t){var e=this,n=oc.f(e),r=n.reject,o=ic((function(){var o=rc(e.resolve);ac(t,(function(t){nc(o,e,t).then(n.resolve,r)}))}));return o.error&&r(o.value),n.promise}});var sc=tt,uc=rs;ro({target:"Promise",stat:!0,forced:ns.CONSTRUCTOR},{reject:function(t){var e=uc.f(this);return sc(e.reject,void 0,t),e.promise}});var cc=K,lc=L,fc=rs,hc=ro,pc=ns.CONSTRUCTOR,dc=function(t,e){if(cc(t),lc(e)&&e.constructor===t)return e;var n=fc.f(t);return(0,n.resolve)(e),n.promise};function gc(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return"function"==typeof e?e(t):e;const n=t.getUTCHours(),r=t.getUTCMinutes(),o=t.getUTCSeconds(),i=t.getUTCMilliseconds();return`${a=t.getUTCFullYear(),a<0?`-${vc(-a,6)}`:a>9999?`+${vc(a,6)}`:vc(a,4)}-${vc(t.getUTCMonth()+1,2)}-${vc(t.getUTCDate(),2)}${n||r||o||i?`T${vc(n,2)}:${vc(r,2)}${o||i?`:${vc(o,2)}${i?`.${vc(i,3)}`:""}`:""}Z`:""}`;var a}function vc(t,e){return`${t}`.padStart(e,"0")}ot("Promise"),hc({target:"Promise",stat:!0,forced:pc},{resolve:function(t){return dc(this,t)}});const mc=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function yc(t,e){return mc.test(t+="")?new Date(t):"function"==typeof e?e(t):e}const bc=Object.getPrototypeOf(Uint8Array),wc=Object.prototype.toString,Pc=t=>null==t?t:`${t}`,Sc=t=>()=>t;function Oc(t,e){return void 0===t&&(t=e),null===t?[void 0,"none"]:Bc(t)?[void 0,t]:[t,void 0]}function jc(t,e){return void 0===t&&(t=e),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function xc(t,e){return null==t?t:void 0===e?t instanceof Array||t instanceof bc?t:Array.from(t):t instanceof e?t:e.from(t)}function $c(t,e,n=Array){return t instanceof n?t.map(e):n.from(t,e)}function Tc(t){return t?.toString===wc}function Rc(t){return Tc(t)&&(void 0!==t.type||void 0!==t.domain)}function Ec(t){for(const e of t){if(null==e)continue;const t=typeof e;return"string"===t||"boolean"===t}}function kc(t){for(const e of t)if(null!=e)return e instanceof Date}function Mc(t){for(const e of t)if(null!=e)return"string"==typeof e&&isNaN(e)&&yc(e)}function Cc(t){for(const e of t)if(null!=e){if("string"!=typeof e)return!1;if(e.trim())return!isNaN(e)}}function qc(t,e){for(const n of t)if(null!=n)return e(n)}function Nc(t,e){for(const n of t)if(null!=n&&!e(n))return!1;return!0}function Bc(t){return"string"==typeof t&&("none"===(t=t.toLowerCase().trim())||"currentcolor"===t||t.startsWith("url(")&&t.endsWith(")")||t.startsWith("var(")&&t.endsWith(")")||null!==e.color(t))}function Ic(t){return null==t||function(t){return/^\s*none\s*$/i.test(t)}(t)}function Ac(t){if(null==t)return;const n=t[0],r=t[t.length-1];return e.descending(n,r)}const Dc=Symbol("position"),Gc=Symbol("color"),Lc=Symbol("radius"),zc=Symbol("length"),Fc=Symbol("opacity"),Yc=Symbol("symbol"),_c=new Map([["x",Dc],["y",Dc],["fx",Dc],["fy",Dc],["r",Lc],["color",Gc],["opacity",Fc],["symbol",Yc],["length",zc]]);function Uc(t){return null!=t&&!Number.isNaN(t)}function Wc(t,n){return+Uc(n)-+Uc(t)||e.ascending(t,n)}function Hc(t){return isFinite(t)?t:NaN}function Vc(t){return t>0&&isFinite(t)?t:NaN}function Xc(t){return t<0&&isFinite(t)?t:NaN}const Jc=new Map([["accent",e.schemeAccent],["category10",e.schemeCategory10],["dark2",e.schemeDark2],["paired",e.schemePaired],["pastel1",e.schemePastel1],["pastel2",e.schemePastel2],["set1",e.schemeSet1],["set2",e.schemeSet2],["set3",e.schemeSet3],["tableau10",e.schemeTableau10],["brbg",Zc(e.schemeBrBG,e.interpolateBrBG)],["prgn",Zc(e.schemePRGn,e.interpolatePRGn)],["piyg",Zc(e.schemePiYG,e.interpolatePiYG)],["puor",Zc(e.schemePuOr,e.interpolatePuOr)],["rdbu",Zc(e.schemeRdBu,e.interpolateRdBu)],["rdgy",Zc(e.schemeRdGy,e.interpolateRdGy)],["rdylbu",Zc(e.schemeRdYlBu,e.interpolateRdYlBu)],["rdylgn",Zc(e.schemeRdYlGn,e.interpolateRdYlGn)],["spectral",Zc(e.schemeSpectral,e.interpolateSpectral)],["burd",Qc(e.schemeRdBu,e.interpolateRdBu)],["buylrd",Qc(e.schemeRdYlBu,e.interpolateRdYlBu)],["blues",Kc(e.schemeBlues,e.interpolateBlues)],["greens",Kc(e.schemeGreens,e.interpolateGreens)],["greys",Kc(e.schemeGreys,e.interpolateGreys)],["oranges",Kc(e.schemeOranges,e.interpolateOranges)],["purples",Kc(e.schemePurples,e.interpolatePurples)],["reds",Kc(e.schemeReds,e.interpolateReds)],["turbo",tl(e.interpolateTurbo)],["viridis",tl(e.interpolateViridis)],["magma",tl(e.interpolateMagma)],["inferno",tl(e.interpolateInferno)],["plasma",tl(e.interpolatePlasma)],["cividis",tl(e.interpolateCividis)],["cubehelix",tl(e.interpolateCubehelixDefault)],["warm",tl(e.interpolateWarm)],["cool",tl(e.interpolateCool)],["bugn",Kc(e.schemeBuGn,e.interpolateBuGn)],["bupu",Kc(e.schemeBuPu,e.interpolateBuPu)],["gnbu",Kc(e.schemeGnBu,e.interpolateGnBu)],["orrd",Kc(e.schemeOrRd,e.interpolateOrRd)],["pubu",Kc(e.schemePuBu,e.interpolatePuBu)],["pubugn",Kc(e.schemePuBuGn,e.interpolatePuBuGn)],["purd",Kc(e.schemePuRd,e.interpolatePuRd)],["rdpu",Kc(e.schemeRdPu,e.interpolateRdPu)],["ylgn",Kc(e.schemeYlGn,e.interpolateYlGn)],["ylgnbu",Kc(e.schemeYlGnBu,e.interpolateYlGnBu)],["ylorbr",Kc(e.schemeYlOrBr,e.interpolateYlOrBr)],["ylorrd",Kc(e.schemeYlOrRd,e.interpolateYlOrRd)],["rainbow",el(e.interpolateRainbow)],["sinebow",el(e.interpolateSinebow)]]);function Kc(t,n){return({length:r})=>1===r?[t[3][1]]:2===r?[t[3][1],t[3][2]]:(r=Math.max(3,Math.floor(r)))>9?e.quantize(n,r):t[r]}function Zc(t,n){return({length:r})=>2===r?[t[3][0],t[3][2]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize(n,r):t[r]}function Qc(t,n){return({length:r})=>2===r?[t[3][2],t[3][0]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize((t=>n(1-t)),r):t[r].slice().reverse()}function tl(t){return({length:n})=>e.quantize(t,Math.max(2,Math.floor(n)))}function el(t){return({length:n})=>e.quantize(t,Math.floor(n)+1).slice(0,-1)}function nl(t){const e=`${t}`.toLowerCase();if(!Jc.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return Jc.get(e)}function rl(t,e){const n=nl(t),r="function"==typeof n?n({length:e}):n;return r.length!==e?r.slice(0,e):r}const ol=new Map([["brbg",e.interpolateBrBG],["prgn",e.interpolatePRGn],["piyg",e.interpolatePiYG],["puor",e.interpolatePuOr],["rdbu",e.interpolateRdBu],["rdgy",e.interpolateRdGy],["rdylbu",e.interpolateRdYlBu],["rdylgn",e.interpolateRdYlGn],["spectral",e.interpolateSpectral],["burd",t=>e.interpolateRdBu(1-t)],["buylrd",t=>e.interpolateRdYlBu(1-t)],["blues",e.interpolateBlues],["greens",e.interpolateGreens],["greys",e.interpolateGreys],["purples",e.interpolatePurples],["reds",e.interpolateReds],["oranges",e.interpolateOranges],["turbo",e.interpolateTurbo],["viridis",e.interpolateViridis],["magma",e.interpolateMagma],["inferno",e.interpolateInferno],["plasma",e.interpolatePlasma],["cividis",e.interpolateCividis],["cubehelix",e.interpolateCubehelixDefault],["warm",e.interpolateWarm],["cool",e.interpolateCool],["bugn",e.interpolateBuGn],["bupu",e.interpolateBuPu],["gnbu",e.interpolateGnBu],["orrd",e.interpolateOrRd],["pubugn",e.interpolatePuBuGn],["pubu",e.interpolatePuBu],["purd",e.interpolatePuRd],["rdpu",e.interpolateRdPu],["ylgnbu",e.interpolateYlGnBu],["ylgn",e.interpolateYlGn],["ylorbr",e.interpolateYlOrBr],["ylorrd",e.interpolateYlOrRd],["rainbow",e.interpolateRainbow],["sinebow",e.interpolateSinebow]]);function il(t){const e=`${t}`.toLowerCase();if(!ol.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return ol.get(e)}const al=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function sl(t){return null!=t&&al.has(`${t}`.toLowerCase())}const ul=function(t){let e,n;return(...r)=>((n?.length!==r.length||n.some(((t,e)=>t!==r[e])))&&(n=r,e=t(...r)),e)}((t=>new Intl.NumberFormat(t)));function cl(t){return gc(t,"Invalid Date")}function ll(t){console.warn(t)}function fl(t,e){if((t=Pc(t))!==e)return t}!function(t="en-US"){const e=function(t="en-US"){const e=ul(t);return t=>null==t||isNaN(t)?void 0:e.format(t)}(t)}();const hl=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/;function pl(t){if(void 0===t)return`plot-${Math.random().toString(16).slice(2)}`;if(t=`${t}`,!hl.test(t))throw new Error(`invalid class name: ${t}`);return t}function dl(t,e){if("string"==typeof e)t.property("style",e);else if(null!=e)for(const n of t)Object.assign(n.style,e)}function gl(t){if(null!=t){if("number"==typeof t){const n=t;return{floor:t=>n*Math.floor(t/n),offset:t=>t+n,range:(t,r)=>e.range(Math.ceil(t/n),r/n).map((t=>n*t))}}if("function"!=typeof t.floor||"function"!=typeof t.offset)throw new Error("invalid interval; missing floor or offset function");return t}}const vl=t=>e=>t(1-e),ml=[0,1],yl=new Map([["number",e.interpolateNumber],["rgb",e.interpolateRgb],["hsl",e.interpolateHsl],["hcl",e.interpolateHcl],["lab",e.interpolateLab]]);function bl(t){const e=`${t}`.toLowerCase();if(!yl.has(e))throw new Error(`unknown interpolator: ${e}`);return yl.get(e)}function wl(t,n,r,{type:o,nice:i,clamp:a,zero:s,domain:u=jl(t,r),unknown:c,round:l,scheme:f,interval:h,range:p=(_c.get(t)===Lc?$l(r,u):_c.get(t)===zc?Tl(r,u):_c.get(t)===Fc?ml:void 0),interpolate:d=(_c.get(t)===Gc?null==f&&void 0!==p?e.interpolateRgb:il(void 0!==f?f:"cyclical"===o?"rainbow":"turbo"):l?e.interpolateRound:e.interpolateNumber),reverse:g}){if(h=gl(h),"cyclical"!==o&&"sequential"!==o||(o="linear"),g=!!g,"function"!=typeof d&&(d=bl(d)),1===d.length?(g&&(d=vl(d),g=!1),void 0===p&&2===(p=Float64Array.from(u,((t,e)=>e/(u.length-1)))).length&&(p=ml),n.interpolate((p===ml?Sc:kl)(d))):n.interpolate(d),s){const[t,n]=e.extent(u);(t>0||n<0)&&(u=function(t,e=Array){return t instanceof e?t.slice():e.from(t)}(u),Ac(u)!==Math.sign(t)?u[u.length-1]=0:u[0]=0)}return g&&(u=e.reverse(u)),n.domain(u).unknown(c),i&&(n.nice(!0===i?void 0:i),u=n.domain()),void 0!==p&&n.range(p),a&&n.clamp(a),{type:o,domain:u,range:p,scale:n,interpolate:d,interval:h}}function Pl(t,n,{exponent:r=1,...o}){return wl(t,e.scalePow().exponent(r),n,{...o,type:"pow"})}function Sl(t,n,{domain:r=[0],unknown:o,scheme:i="rdylbu",interpolate:a,range:s=(void 0!==a?e.quantize(a,r.length+1):_c.get(t)===Gc?rl(i,r.length+1):void 0),reverse:u}){const c=Ac(xc(r));if(!e.pairs(r).every((([t,n])=>function(t,n,r){const o=e.descending(t,n);return 0===o||o===r}(t,n,c))))throw new Error(`the ${t} scale has a non-monotonic domain`);return u&&(s=e.reverse(s)),{type:"threshold",scale:e.scaleThreshold(c<0?e.reverse(r):r,void 0===s?[]:s).unknown(o),domain:r,range:s}}function Ol(t,n=Hc){return t.length?[e.min(t,(({value:t})=>void 0===t?t:e.min(t,n))),e.max(t,(({value:t})=>void 0===t?t:e.max(t,n)))]:[0,1]}function jl(t,e){const n=_c.get(t);return(n===Lc||n===Fc||n===zc?xl:Ol)(e)}function xl(t){return[0,t.length?e.max(t,(({value:t})=>void 0===t?t:e.max(t,Hc))):1]}function $l(t,n){const r=t.find((({radius:t})=>void 0!==t));if(void 0!==r)return[0,r.radius];const o=e.quantile(t,.5,(({value:t})=>void 0===t?NaN:e.quantile(t,.25,Vc))),i=n.map((t=>3*Math.sqrt(t/o))),a=30/e.max(i);return a<1?i.map((t=>t*a)):i}function Tl(t,n){const r=e.median(t,(({value:t})=>void 0===t?NaN:e.median(t,Math.abs))),o=n.map((t=>12*t/r)),i=60/e.max(o);return i<1?o.map((t=>t*i)):o}function Rl(t){for(const{value:e}of t)if(void 0!==e)for(let n of e){if(n=+n,n>0)return Ol(t,Vc);if(n<0)return Ol(t,Xc)}return[1,10]}function El(t){const e=[];for(const{value:n}of t)if(void 0!==n)for(const t of n)e.push(t);return e}function kl(t){return(e,n)=>r=>t(e+r*(n-e))}function Ml(t,n,r,o,{type:i,nice:a,clamp:s,domain:u=Ol(o),unknown:c,pivot:l=0,scheme:f,range:h,symmetric:p=!0,interpolate:d=(_c.get(t)===Gc?null==f&&void 0!==h?e.interpolateRgb:il(void 0!==f?f:"rdbu"):e.interpolateNumber),reverse:g}){l=+l;let[v,m]=u;if(v=Math.min(v,l),m=Math.max(m,l),"function"!=typeof d&&(d=bl(d)),void 0!==h&&(d=1===d.length?kl(d)(...h):e.piecewise(d,h)),g&&(d=vl(d)),p){const t=r.apply(l),e=t-r.apply(v),n=r.apply(m)-t;e<n?v=r.invert(t-n):e>n&&(m=r.invert(t+e))}return n.domain([v,l,m]).unknown(c).interpolator(d),s&&n.clamp(s),a&&n.nice(a),{type:i,domain:[v,m],pivot:l,interpolate:d,scale:n}}function Cl(t,n,{exponent:r=1,...o}){return Ml(t,e.scaleDivergingPow().exponent(r=+r),function(t){return.5===t?Il:{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),t),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/t)}}(r),n,{...o,type:"diverging-pow"})}function ql(t,n,{constant:r=1,...o}){return Ml(t,e.scaleDivergingSymlog().constant(r=+r),function(t){return{apply:e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),invert:e=>Math.sign(e)*Math.expm1(Math.abs(e))*t}}(r),n,o)}const Nl={apply:t=>t,invert:t=>t},Bl={apply:Math.log,invert:Math.exp},Il={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function Al(t,e,n,r){return wl(t,e,n,r)}const Dl=2/Math.sqrt(3),Gl={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*Dl,o=r/2;t.moveTo(0,r),t.lineTo(n,o),t.lineTo(n,-o),t.lineTo(0,-r),t.lineTo(-n,-o),t.lineTo(-n,o),t.closePath()}},Ll=new Map([["asterisk",e.symbolAsterisk],["circle",e.symbolCircle],["cross",e.symbolCross],["diamond",e.symbolDiamond],["diamond2",e.symbolDiamond2],["hexagon",Gl],["plus",e.symbolPlus],["square",e.symbolSquare],["square2",e.symbolSquare2],["star",e.symbolStar],["times",e.symbolX],["triangle",e.symbolTriangle],["triangle2",e.symbolTriangle2],["wye",e.symbolWye]]);function zl(t){return t&&"function"==typeof t.draw}function Fl(t){return!!zl(t)||"string"==typeof t&&Ll.has(t.toLowerCase())}function Yl(t){if(null==t||zl(t))return t;const e=Ll.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}const _l=Symbol("ordinal");function Ul(t,n,r,{type:o,interval:i,domain:a,range:s,reverse:u,hint:c}){return i=gl(i),void 0===a&&(a=Vl(r,i,t)),"categorical"!==o&&o!==_l||(o="ordinal"),u&&(a=e.reverse(a)),n.domain(a),void 0!==s&&("function"==typeof s&&(s=s(a)),n.range(s)),{type:o,domain:a,range:s,scale:n,hint:c,interval:i}}function Wl(t,n,{type:r,interval:o,domain:i,range:a,scheme:s,unknown:u,...c}){let l;if(o=gl(o),void 0===i&&(i=Vl(n,o,t)),_c.get(t)===Yc)l=function(t){return{fill:Xl(t,"fill"),stroke:Xl(t,"stroke")}}(n),a=void 0===a?function(t){return Ic(t.fill)?e.symbolsStroke:e.symbolsFill}(l):$c(a,Yl);else if(_c.get(t)===Gc&&(void 0!==a||"ordinal"!==r&&r!==_l||(a=function(t,e="greys"){const n=new Set,[r,o]=rl(e,2);for(const e of t)if(null!=e)if(!0===e)n.add(o);else{if(!1!==e)return;n.add(r)}return[...n]}(i,s),void 0!==a&&(s=void 0)),void 0===s&&void 0===a&&(s="ordinal"===r?"turbo":"tableau10"),void 0!==s))if(void 0!==a){const t=il(s),n=a[0],r=a[1]-a[0];a=({length:o})=>e.quantize((e=>t(n+r*e)),o)}else a=nl(s);if(u===e.scaleImplicit)throw new Error("implicit unknown is not supported");return Ul(t,e.scaleOrdinal().unknown(u),n,{...c,type:r,domain:i,range:a,hint:l})}function Hl(t,e,n,r){let{round:o}=n;return void 0!==o&&t.round(o=!!o),(t=Ul(r,t,e,n)).round=o,t}function Vl(t,n,r){const o=new e.InternSet;for(const{value:e,domain:n}of t){if(void 0!==n)return n();if(void 0!==e)for(const t of e)o.add(t)}if(void 0!==n){const[t,r]=e.extent(o).map(n.floor,n);return n.range(t,n.offset(r))}if(o.size>1e4&&_c.get(r)===Dc)throw new Error("implicit ordinal position domain has more than 10,000 values");return e.sort(o,Wc)}function Xl(t,e){let n;for(const{hint:r}of t){const t=r?.[e];if(void 0!==t)if(void 0===n)n=t;else if(n!==t)return}return n}function Jl(t,n,r){return function(t,n=[],r={}){const o=function(t,e,{type:n,domain:r,range:o,scheme:i,pivot:a,projection:s}){if("fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==s||(n=Zl);for(const{type:t}of e)if(void 0!==t)if(void 0===n)n=t;else if(n!==t)throw new Error(`scale incompatible with channel: ${n} !== ${t}`);if(n===Zl)return;if(void 0!==n)return n;if(void 0===r&&!e.some((({value:t})=>void 0!==t)))return;const u=_c.get(t);if(u===Gc&&void 0===o&&void 0===i&&tf(r,e,Bc))return"identity";if(u===Yc&&void 0===o&&tf(r,e,Fl))return"identity";if(u===Lc)return"sqrt";if(u===Fc||u===zc)return"linear";if(u===Yc)return"ordinal";if((r||o||[]).length>2)return Ql(u);if(void 0!==r)return Ec(r)?Ql(u):kc(r)?"utc":u!==Gc||null==a&&!sl(i)?"linear":"diverging";const c=e.map((({value:t})=>t)).filter((t=>void 0!==t));return c.some(Ec)?Ql(u):c.some(kc)?"utc":u!==Gc||null==a&&!sl(i)?"linear":"diverging"}(t,n,r);if(void 0===r.type&&void 0===r.domain&&void 0===r.range&&null==r.interval&&"fx"!==t&&"fy"!==t&&ef({type:o})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(kc)?ll(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${Kl(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${Kl(o)}".`):e.some(Mc)?ll(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${Kl(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${Kl(o)}".`):e.some(Cc)&&ll(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${Kl(o)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${Kl(o)}".`)}switch(r.type=o,o){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":r=nf(n,r,af);break;case"identity":switch(_c.get(t)){case Dc:r=nf(n,r,af);break;case Yc:r=nf(n,r,rf)}break;case"utc":case"time":r=nf(n,r,of)}switch(o){case"diverging":return function(t,n,r){return Ml(t,e.scaleDiverging(),Nl,n,r)}(t,n,r);case"diverging-sqrt":return function(t,e,n){return Cl(t,e,{...n,exponent:.5})}(t,n,r);case"diverging-pow":return Cl(t,n,r);case"diverging-log":return function(t,n,{base:r=10,pivot:o=1,domain:i=Ol(n,o<0?Xc:Vc),...a}){return Ml(t,e.scaleDivergingLog().base(r=+r),Bl,n,{domain:i,pivot:o,...a})}(t,n,r);case"diverging-symlog":return ql(t,n,r);case"categorical":case"ordinal":case _l:return Wl(t,n,r);case"cyclical":case"sequential":case"linear":return function(t,n,r){return wl(t,e.scaleLinear(),n,r)}(t,n,r);case"sqrt":return function(t,e,n){return Pl(t,e,{...n,exponent:.5})}(t,n,r);case"threshold":return Sl(t,0,r);case"quantile":return function(t,n,{range:r,quantiles:o=(void 0===r?5:(r=[...r]).length),n:i=o,scheme:a="rdylbu",domain:s=El(n),interpolate:u,reverse:c}){return void 0===r&&(r=void 0!==u?e.quantize(u,i):_c.get(t)===Gc?rl(a,i):void 0),Sl(t,0,{domain:e.scaleQuantile(s,void 0===r?{length:i}:r).quantiles(),range:r,reverse:c})}(t,n,r);case"quantize":return function(t,n,{range:r,n:o=(void 0===r?5:(r=[...r]).length),scheme:i="rdylbu",domain:a=jl(t,n),unknown:s,interpolate:u,reverse:c}){const[l,f]=e.extent(a);let h;return void 0===r?(h=e.ticks(l,f,o),h[0]<=l&&h.splice(0,1),h[h.length-1]>=f&&h.pop(),o=h.length+1,r=void 0!==u?e.quantize(u,o):_c.get(t)===Gc?rl(i,o):void 0):(h=e.quantize(e.interpolateNumber(l,f),o+1).slice(1,-1),l instanceof Date&&(h=h.map((t=>new Date(t))))),Ac(xc(a))<0&&h.reverse(),Sl(t,0,{domain:h,range:r,reverse:c,unknown:s})}(t,n,r);case"pow":return Pl(t,n,r);case"log":return function(t,n,{base:r=10,domain:o=Rl(n),...i}){return wl(t,e.scaleLog().base(r),n,{...i,domain:o})}(t,n,r);case"symlog":return function(t,n,{constant:r=1,...o}){return wl(t,e.scaleSymlog().constant(r),n,o)}(t,n,r);case"utc":return function(t,n,r){return Al(t,e.scaleUtc(),n,r)}(t,n,r);case"time":return function(t,n,r){return Al(t,e.scaleTime(),n,r)}(t,n,r);case"point":return function(t,n,{align:r=.5,padding:o=.5,...i}){return Hl(e.scalePoint().align(r).padding(o),n,i,t)}(t,n,r);case"band":return function(t,n,{align:r=.5,padding:o=.1,paddingInner:i=o,paddingOuter:a=("fx"===t||"fy"===t?0:o),...s}){return Hl(e.scaleBand().align(r).paddingInner(i).paddingOuter(a),n,s,t)}(t,n,r);case"identity":return _c.get(t)===Dc?{type:"identity",scale:e.scaleIdentity()}:{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${o}`)}}(t,void 0===r?void 0:[{hint:r}],{...n})}function Kl(t){return"symbol"==typeof t?t.description:t}const Zl={toString:()=>"projection"};function Ql(t){switch(t){case Dc:return"point";case Gc:return _l;default:return"ordinal"}}function tf(t,e,n){return void 0!==t?qc(t,n)&&Nc(t,n):e.some((({value:t})=>void 0!==t&&qc(t,n)))&&e.every((({value:t})=>void 0===t||Nc(t,n)))}function ef({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===_l}function nf(t,{domain:e,...n},r){for(const e of t)void 0!==e.value&&(e.value=r(e.value));return{domain:void 0===e?e:r(e),...n}}function rf(t){return $c(t,Yl)}function of(t){return $c(t,uf)}function af(t){return function(t){return t instanceof bc}(t)?t:$c(t,sf,Float64Array)}function sf(t){return null==t?NaN:+t}function uf(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?yc(t):null==t||isNaN(t=+t)?void 0:new Date(t)}const cf=Math.PI,lf=2*cf;function ff({projection:t,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n}={},s){if(null==t)return;if("function"==typeof t.stream)return t;let u,c,l="frame";if(Tc(t)){let e;if(({type:t,domain:c,inset:e,insetTop:r=(void 0!==e?e:r),insetRight:o=(void 0!==e?e:o),insetBottom:i=(void 0!==e?e:i),insetLeft:a=(void 0!==e?e:a),clip:l=l,...u}=t),null==t)return}"function"!=typeof t&&({type:t}=function(t){switch(`${t}`.toLowerCase()){case"albers-usa":return hf(e.geoAlbersUsa,.7463,.4673);case"albers":return pf(e.geoAlbers,.7463,.4673);case"azimuthal-equal-area":return hf(e.geoAzimuthalEqualArea,4,4);case"azimuthal-equidistant":return hf(e.geoAzimuthalEquidistant,lf,lf);case"conic-conformal":return pf(e.geoConicConformal,lf,lf);case"conic-equal-area":return pf(e.geoConicEqualArea,6.1702,2.9781);case"conic-equidistant":return pf(e.geoConicEquidistant,7.312,3.6282);case"equal-earth":return hf(e.geoEqualEarth,5.4133,2.6347);case"equirectangular":return hf(e.geoEquirectangular,lf,cf);case"gnomonic":return hf(e.geoGnomonic,3.4641,3.4641);case"identity":return{type:df};case"reflect-y":return{type:gf};case"mercator":return hf(e.geoMercator,lf,lf);case"orthographic":return hf(e.geoOrthographic,2,2);case"stereographic":return hf(e.geoStereographic,2,2);case"transverse-mercator":return hf(e.geoTransverseMercator,lf,lf);default:throw new Error(`unknown projection type: ${t}`)}}(t));const{width:f,height:h,marginLeft:p,marginRight:d,marginTop:g,marginBottom:v}=s,m=f-p-d-a-o,y=h-g-v-r-i;if(t=t?.({width:m,height:y,clip:l,...u}),null==t)return;l=function(t,n,r,o,i){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return e.geoClipRectangle(n,r,o,i);throw new Error(`unknown projection clip type: ${t}`)}(l,p,g,f-d,h-v);let b,w=p+a,P=g+r;if(null!=c){const[[n,r],[o,i]]=e.geoPath(t).bounds(c),a=Math.min(m/(o-n),y/(i-r));a>0?(w-=(a*(n+o)-m)/2,P-=(a*(r+i)-y)/2,b=e.geoTransform({point(t,e){this.stream.point(t*a+w,e*a+P)}})):ll("Warning: the projection could not be fit to the specified domain; using the default scale.")}return b??=0===w&&0===P?df():e.geoTransform({point(t,e){this.stream.point(t+w,e+P)}}),{stream:e=>t.stream(b.stream(l(e)))}}function hf(t,e,n){return{type:({width:r,height:o,rotate:i,precision:a=.15,clip:s})=>{const u=t();return null!=a&&u.precision?.(a),null!=i&&u.rotate?.(i),"number"==typeof s&&u.clipAngle?.(s),u.scale(Math.min(r/e,o/n)),u.translate([r/2,o/2]),u},aspectRatio:n/e}}function pf(t,e,n){const{type:r,aspectRatio:o}=hf(t,e,n);return{type:t=>{const{parallels:e,domain:n,width:o,height:i}=t,a=r(t);return null!=e&&(a.parallels(e),void 0===n&&a.fitSize([o,i],{type:"Sphere"})),a},aspectRatio:o}}const df=Sc({stream:t=>t}),gf=Sc(e.geoTransform({point(t,e){this.stream.point(t,-e)}}));function vf(t={},e){const{document:n=("undefined"!=typeof window?window.document:void 0)}=t;return{document:n,projection:ff(t,e)}}function mf(t,{document:n}){return e.select(e.creator(t).call(n.documentElement))}function yf(t){return ef(t)&&void 0===t.interval?void 0:"tabular-nums"}function bf(t,e){if(null==e)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function wf(t,n={},r,o){let{columns:i,tickFormat:a,fontVariant:s=yf(t),swatchSize:u=15,swatchWidth:c=u,swatchHeight:l=u,marginLeft:f=0,className:h,style:p,width:d}=n;const g=vf(n);h=pl(h),a=function(t,n){return void 0===t?kc(n)?cl:Pc:"function"==typeof t?t:("string"==typeof t?kc(n)?e.utcFormat:e.format:Sc)(t)}(a,t.domain);const v=mf("div",g).attr("class",h).attr("style",`\n        --swatchWidth: ${+c}px;\n        --swatchHeight: ${+l}px;\n      `);let m;return null!=i?(m=`\n      .${h}-swatch {\n        display: flex;\n        align-items: center;\n        break-inside: avoid;\n        padding-bottom: 1px;\n      }\n      .${h}-swatch::before {\n        flex-shrink: 0;\n      }\n      .${h}-label {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n    `,v.style("columns",i).selectAll().data(t.domain).enter().append("div").attr("class",`${h}-swatch`).call(r,t).call((t=>t.append("div").attr("class",`${h}-label`).attr("title",a).text(a)))):(m=`\n      .${h} {\n        display: flex;\n        align-items: center;\n        min-height: 33px;\n        flex-wrap: wrap;\n      }\n      .${h}-swatch {\n        display: inline-flex;\n        align-items: center;\n        margin-right: 1em;\n      }\n    `,v.selectAll().data(t.domain).enter().append("span").attr("class",`${h}-swatch`).call(r,t).append((function(){return this.ownerDocument.createTextNode(a.apply(this,arguments))}))),v.call((t=>t.insert("style","*").text(`\n        .${h} {\n          font-family: system-ui, sans-serif;\n          font-size: 10px;\n          margin-bottom: 0.5em;${void 0===f?"":`\n          margin-left: ${+f}px;`}${void 0===d?"":`\n          width: ${d}px;`}\n        }\n        ${o(h)}\n        ${m}\n      `))).style("font-variant",fl(s,"normal")).call(dl,p).node()}const Pf=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:r=1,stroke:o=(void 0!==t.hint?.stroke?t.hint.stroke:Ic(n)?"currentColor":"none"),strokeOpacity:i=1,strokeWidth:a=1.5,r:s=4.5,...u}={},c){const[l,f]=Oc(n),[h,p]=Oc(o),d=bf(c,l),g=bf(c,h),v=s*s*Math.PI;return r=jc(r)[1],i=jc(i)[1],a=jc(a)[1],wf(t,u,(n=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("fill","color"===l?t=>d.scale(t):null).attr("stroke","color"===h?t=>g.scale(t):null).append("path").attr("d",(n=>{const r=e.path();return t.scale(n).draw(r,v),r}))),(t=>`.${t}-swatch > svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n        overflow: visible;\n        fill: ${f};\n        fill-opacity: ${r};\n        stroke: ${p};\n        stroke-width: ${a}px;\n        stroke-opacity: ${i};\n      }`))}],["color",Of],["opacity",function({type:t,interpolate:n,...r},{legend:o=!0,color:i=e.rgb(0,0,0),...a}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===o&&(o="ramp");if("ramp"!==`${o}`.toLowerCase())throw new Error(`${o} opacity legends are not supported`);return Of({type:t,...r,interpolate:jf(i)},{legend:o,...a})}]]);function Sf(t,{label:e,ticks:n,tickFormat:r}={},o){return function(t={},...e){let n=t;for(const r of e)for(const e in r)if(void 0===n[e]){const o=r[e];n===t?n={...n,[e]:o}:n[e]=o}return n}(o,t,{label:e,ticks:n,tickFormat:r})}function Of(t,{legend:n=!0,...r}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,e){if(!ef(t)&&!function({type:t}){return"threshold"===t}(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return wf(t,e,((t,e)=>t.append("svg").attr("fill",e.scale).append("rect").attr("width","100%").attr("height","100%")),(t=>`.${t}-swatch svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n      }`))}(t,r);case"ramp":return function(t,n){let{label:r=t.label,tickSize:o=6,width:i=240,height:a=44+o,marginTop:s=18,marginRight:u=0,marginBottom:c=16+o,marginLeft:l=0,style:f,ticks:h=(i-l-u)/64,tickFormat:p,fontVariant:d=yf(t),round:g=!0,className:v}=n;const m=vf(n);v=pl(v),null===p&&(p=()=>null);const y=mf("svg",m).attr("class",v).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",a).attr("viewBox",`0 0 ${i} ${a}`).call((t=>t.append("style").text(`\n        .${v} {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n          overflow: visible;\n        }\n        .${v} text {\n          white-space: pre;\n        }\n      `))).call(dl,f);let b,w=t=>t.selectAll(".tick line").attr("y1",s+c-a);const P=g?(t,e)=>t.rangeRound(e):(t,e)=>t.range(e),{type:S,domain:O,range:j,interpolate:x,scale:$,pivot:T}=t;if(x){const t=void 0===j?x:e.piecewise(1===x.length?kl(x):x,j);b=P($.copy(),e.quantize(e.interpolateNumber(l,i-u),Math.min(O.length+(void 0!==T),void 0===j?1/0:j.length)));const n=256,r=m.document.createElement("canvas");r.width=n,r.height=1;const o=r.getContext("2d");for(let e=0,r=n-1;e<n;++e)o.fillStyle=t(e/r),o.fillRect(e,0,1,1);y.append("image").attr("x",l).attr("y",s).attr("width",i-l-u).attr("height",a-s-c).attr("preserveAspectRatio","none").attr("xlink:href",r.toDataURL())}else if("threshold"===S){const t=O,n=void 0===p?t=>t:"string"==typeof p?e.format(p):p;b=P(e.scaleLinear().domain([-1,j.length-1]),[l,i-u]),y.append("g").selectAll().data(j).enter().append("rect").attr("x",((t,e)=>b(e-1))).attr("y",s).attr("width",((t,e)=>b(e)-b(e-1))).attr("height",a-s-c).attr("fill",(t=>t)),h=$c(t,((t,e)=>e)),p=e=>n(t[e],e)}else b=P(e.scaleBand().domain(O),[l,i-u]),y.append("g").selectAll().data(O).enter().append("rect").attr("x",b).attr("y",s).attr("width",Math.max(0,b.bandwidth()-1)).attr("height",a-s-c).attr("fill",$),w=()=>{};return y.append("g").attr("transform",`translate(0,${a-c})`).call(e.axisBottom(b).ticks(Array.isArray(h)?null:h,"string"==typeof p?p:void 0).tickFormat("function"==typeof p?p:void 0).tickSize(o).tickValues(Array.isArray(h)?h:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",fl(d,"normal")).call(w).call((t=>t.select(".domain").remove())),void 0!==r&&y.append("text").attr("x",l).attr("y",s-6).attr("fill","currentColor").attr("font-weight","bold").text(r),y.node()}(t,r);default:throw new Error(`unknown legend type: ${n}`)}}function jf(t){const{r:n,g:r,b:o}=e.rgb(t)||e.rgb(0,0,0);return t=>`rgba(${n},${r},${o},${t})`}function xf(t,e,n,r,o){for(var i=o+1;r<=o;){var a=r+o>>>1,s=t[a];(void 0!==n?n(s,e):s-e)>=0?(i=a,o=a-1):r=a+1}return i}function $f(t,e,n,r,o){for(var i=o+1;r<=o;){var a=r+o>>>1,s=t[a];(void 0!==n?n(s,e):s-e)>0?(i=a,o=a-1):r=a+1}return i}function Tf(t,e,n,r,o){for(var i=r-1;r<=o;){var a=r+o>>>1,s=t[a];(void 0!==n?n(s,e):s-e)<0?(i=a,r=a+1):o=a-1}return i}function Rf(t,e,n,r,o){for(var i=r-1;r<=o;){var a=r+o>>>1,s=t[a];(void 0!==n?n(s,e):s-e)<=0?(i=a,r=a+1):o=a-1}return i}function Ef(t,e,n,r,o){for(;r<=o;){var i=r+o>>>1,a=t[i],s=void 0!==n?n(a,e):a-e;if(0===s)return i;s<=0?r=i+1:o=i-1}return-1}function kf(t,e,n,r,o,i){return"function"==typeof n?i(t,e,n,void 0===r?0:0|r,void 0===o?t.length-1:0|o):i(t,e,void 0,void 0===n?0:0|n,void 0===r?t.length-1:0|r)}var Mf={ge:function(t,e,n,r,o){return kf(t,e,n,r,o,xf)},gt:function(t,e,n,r,o){return kf(t,e,n,r,o,$f)},lt:function(t,e,n,r,o){return kf(t,e,n,r,o,Tf)},le:function(t,e,n,r,o){return kf(t,e,n,r,o,Rf)},eq:function(t,e,n,r,o){return kf(t,e,n,r,o,Ef)}};function Cf(t,e,n,r,o){this.mid=t,this.left=e,this.right=n,this.leftPoints=r,this.rightPoints=o,this.count=(e?e.count:0)+(n?n.count:0)+r.length}var qf=Cf.prototype;function Nf(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function Bf(t,e){var n=_f(e);t.mid=n.mid,t.left=n.left,t.right=n.right,t.leftPoints=n.leftPoints,t.rightPoints=n.rightPoints,t.count=n.count}function If(t,e){var n=t.intervals([]);n.push(e),Bf(t,n)}function Af(t,e){var n=t.intervals([]),r=n.indexOf(e);return r<0?0:(n.splice(r,1),Bf(t,n),1)}function Df(t,e,n){for(var r=0;r<t.length&&t[r][0]<=e;++r){var o=n(t[r]);if(o)return o}}function Gf(t,e,n){for(var r=t.length-1;r>=0&&t[r][1]>=e;--r){var o=n(t[r]);if(o)return o}}function Lf(t,e){for(var n=0;n<t.length;++n){var r=e(t[n]);if(r)return r}}function zf(t,e){return t-e}function Ff(t,e){var n=t[0]-e[0];return n||t[1]-e[1]}function Yf(t,e){var n=t[1]-e[1];return n||t[0]-e[0]}function _f(t){if(0===t.length)return null;for(var e=[],n=0;n<t.length;++n)e.push(t[n][0],t[n][1]);e.sort(zf);var r=e[e.length>>1],o=[],i=[],a=[];for(n=0;n<t.length;++n){var s=t[n];s[1]<r?o.push(s):r<s[0]?i.push(s):a.push(s)}var u=a,c=a.slice();return u.sort(Ff),c.sort(Yf),new Cf(r,_f(o),_f(i),u,c)}qf.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t},qf.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?If(this,t):this.left.insert(t):this.left=_f([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?If(this,t):this.right.insert(t):this.right=_f([t]);else{var n=Mf.ge(this.leftPoints,t,Ff),r=Mf.ge(this.rightPoints,t,Yf);this.leftPoints.splice(n,0,t),this.rightPoints.splice(r,0,t)}},qf.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(e-1)?Af(this,t):2===(i=this.left.remove(t))?(this.left=null,this.count-=1,1):(1===i&&(this.count-=1),i):0;if(t[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(e-1)?Af(this,t):2===(i=this.right.remove(t))?(this.right=null,this.count-=1,1):(1===i&&(this.count-=1),i):0;if(1===this.count)return this.leftPoints[0]===t?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===t){if(this.left&&this.right){for(var n=this,r=this.left;r.right;)n=r,r=r.right;if(n===this)r.right=this.right;else{var o=this.left,i=this.right;n.count-=r.count,n.right=r.left,r.left=o,r.right=i}Nf(this,r),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?Nf(this,this.left):Nf(this,this.right);return 1}for(o=Mf.ge(this.leftPoints,t,Ff);o<this.leftPoints.length&&this.leftPoints[o][0]===t[0];++o)if(this.leftPoints[o]===t){this.count-=1,this.leftPoints.splice(o,1);for(i=Mf.ge(this.rightPoints,t,Yf);i<this.rightPoints.length&&this.rightPoints[i][1]===t[1];++i)if(this.rightPoints[i]===t)return this.rightPoints.splice(i,1),1}return 0},qf.queryPoint=function(t,e){if(t<this.mid){if(this.left)if(n=this.left.queryPoint(t,e))return n;return Df(this.leftPoints,t,e)}if(t>this.mid){var n;if(this.right)if(n=this.right.queryPoint(t,e))return n;return Gf(this.rightPoints,t,e)}return Lf(this.leftPoints,e)},qf.queryInterval=function(t,e,n){var r;if(t<this.mid&&this.left&&(r=this.left.queryInterval(t,e,n)))return r;if(e>this.mid&&this.right&&(r=this.right.queryInterval(t,e,n)))return r;return e<this.mid?Df(this.leftPoints,e,n):t>this.mid?Gf(this.rightPoints,t,n):Lf(this.leftPoints,n)};var Uf=function(t){this.root=t}.prototype;Uf.insert=function(t){this.root?this.root.insert(t):this.root=new Cf(t[0],null,null,[t],[t])},Uf.remove=function(t){if(this.root){var e=this.root.remove(t);return 2===e&&(this.root=null),0!==e}return!1},Uf.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)},Uf.queryInterval=function(t,e,n){if(t<=e&&this.root)return this.root.queryInterval(t,e,n)},Object.defineProperty(Uf,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(Uf,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});var Wf=".graph-legend",Hf={enabled:!0,itemSelector:null,label:null,width:130},Vf=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="Legend",this.calendar=t,this.root=null,this.shown=!1,this.options=Hf}var o,i,a;return o=e,i=[{key:"setup",value:function(t){this.options=Object.assign(Object.assign({},Hf),t)}},{key:"paint",value:function(){var e=this.calendar.options.options.scale,n=this.options,o=n.enabled,i=n.itemSelector;if(!o||i&&t.select(i).empty())return this.destroy();this.shown=!0,this.root=t.select(i||this.calendar.options.options.itemSelector),this.root.select(Wf).empty()?this.root=this.root.append("svg").attr("class",Wf.slice(1)):this.root=this.root.select(Wf);var a,s,u,c=function(t={}){for(const[e,n]of Pf){const r=t[e];if(Rc(r)){const o=vf(t);let i;if("symbol"===e){const{fill:e,stroke:n=(void 0===e&&Rc(t.color)?"color":void 0)}=t;i={fill:e,stroke:n}}return n(Jl(e,r,i),Sf(o,r,t),(e=>Rc(t[e])?Jl(e,t[e]):null))}}throw new Error("unknown legend type; no scale found")}(Object.assign((a={},s=e.as,u=e,(s=r(s))in a?Object.defineProperty(a,s,{value:u,enumerable:!0,configurable:!0,writable:!0}):a[s]=u,a),this.options));return this.root.selectAll("*").remove(),this.root.append((function(){return c})),Promise.resolve()}},{key:"destroy",value:function(){return null!==this.root&&(this.root.remove(),this.root=null),Promise.resolve()}}],i&&n(o.prototype,i),a&&n(o,a),Object.defineProperty(o,"prototype",{writable:!1}),e}();return Vf}));//# sourceMappingURL=Legend.min.js.map
